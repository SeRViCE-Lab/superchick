#! /bin/bash
echo -e "Clean current directory? [yn]"
read res

is_yes() {
        yesses={y,Y,yes,Yes,YES}
        if [[ $yesses =~ $1 ]]; then
                echo 1
        fi
        }

is_no() {
        noses={n,N,no,No,No}
        if [[ $noses =~ $1 ]]; then
                echo 1
        fi
        }

if [ $(is_yes $res) ]; then
   echo -e "cleaning up cwd"
   rm -rf *;
else
   echo "Proceeding with compilation"
fi

cmake ..;

if [ -f "$SOFA_ROOT/lib/libIAB.so" ]; then
  echo "removing \"$SOFA_ROOT/lib/libIAB.so\" "
  rm "$SOFA_ROOT/lib/libIAB.so"
elif [ -f "$SOFA_ROOT/lib/libIAB.dylib" ]; then
  echo "removing \"$SOFA_ROOT/lib/libIAB.dylib\" "
  rm "$SOFA_ROOT/lib/libIAB.dylib"
fi

make DESTDIR="$SOFA_ROOT/lib" -j8; make install

./IAB_Launcher
